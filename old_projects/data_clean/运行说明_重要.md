# ⚠️ 重要：运行程序前必须激活虚拟环境

## 问题说明

如果遇到 `ModuleNotFoundError: No module named 'PIL'` 错误，说明你没有激活虚拟环境。

从错误信息可以看到：
```
/Users/100buy/Library/Python/3.9/lib/python/site-packages/
```
这是系统 Python，不是虚拟环境。

## 解决方案

### 方法1：激活虚拟环境（推荐）

```bash
cd /Users/100buy/新链路/data_clean
source venv/bin/activate  # 激活虚拟环境
python3 download_images.py
```

激活后，命令行提示符会显示 `(venv)`：
```bash
(venv) user@computer:~/新链路/data_clean$ python3 download_images.py
```

### 方法2：使用虚拟环境的 Python 直接运行

```bash
cd /Users/100buy/新链路/data_clean
./venv/bin/python3 download_images.py
```

### 方法3：在 IDE 中配置

#### VSCode
1. 按 `Cmd+Shift+P`（Mac）或 `Ctrl+Shift+P`（Windows）
2. 输入 `Python: Select Interpreter`
3. 选择 `./venv/bin/python3`

#### PyCharm
1. File → Settings → Project → Python Interpreter
2. 选择 `./venv/bin/python3`

## 验证虚拟环境

运行以下命令验证：

```bash
cd /Users/100buy/新链路/data_clean
source venv/bin/activate
python3 -c "from PIL import Image; print('✓ Pillow 已安装')"
```

如果显示 `✓ Pillow 已安装`，说明虚拟环境配置正确。

## 常见错误

### 错误1：ModuleNotFoundError: No module named 'PIL'
**原因**：没有激活虚拟环境  
**解决**：激活虚拟环境后再运行

### 错误2：ModuleNotFoundError: No module named 'requests'
**原因**：虚拟环境中缺少依赖  
**解决**：
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### 错误3：找不到 venv 目录
**原因**：虚拟环境未创建  
**解决**：
```bash
cd /Users/100buy/新链路/data_clean
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

## 快速检查清单

运行程序前，确保：

- [ ] 已进入 `data_clean` 目录
- [ ] 已激活虚拟环境（命令行显示 `(venv)`）
- [ ] 已安装所有依赖：`pip install -r requirements.txt`
- [ ] 可以导入 Pillow：`python3 -c "from PIL import Image"`

## 正确的运行流程

```bash
# 1. 进入目录
cd /Users/100buy/新链路/data_clean

# 2. 激活虚拟环境
source venv/bin/activate

# 3. 确认依赖已安装
pip list | grep -E "(Pillow|requests|pytz)"

# 4. 运行程序
python3 download_images.py
```

## 如果仍然有问题

1. **重新安装依赖**：
   ```bash
   source venv/bin/activate
   pip install --upgrade -r requirements.txt
   ```

2. **检查虚拟环境**：
   ```bash
   which python3  # 应该显示 venv/bin/python3
   ```

3. **重新创建虚拟环境**（最后手段）：
   ```bash
   rm -rf venv
   python3 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```

